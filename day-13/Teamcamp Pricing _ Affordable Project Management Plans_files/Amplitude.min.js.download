var Amplitude_RS=function(e){"use strict";var t="Amplitude";function r(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function n(e){return function t(n){return 0===arguments.length||r(n)?t:e.apply(this,arguments)}}function o(e){return function t(o,s){switch(arguments.length){case 0:return t;case 1:return r(o)?t:n(function(t){return e(o,t)});default:return r(o)&&r(s)?t:r(o)?n(function(t){return e(t,s)}):r(s)?n(function(t){return e(o,t)}):e(o,s)}}}const s=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function i(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}function a(e,t,r){for(var n=0,o=r.length;n<o;){if(e(t,r[n]))return!0;n+=1}return!1}function c(e,t){return Object.prototype.hasOwnProperty.call(t,e)}const u="function"==typeof Object.is?Object.is:function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};var l=Object.prototype.toString,p=function(){return"[object Arguments]"===l.call(arguments)?function(e){return"[object Arguments]"===l.call(e)}:function(e){return c("callee",e)}}(),d=!{toString:null}.propertyIsEnumerable("toString"),f=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],h=function(){return arguments.propertyIsEnumerable("length")}(),v=function(e,t){for(var r=0;r<e.length;){if(e[r]===t)return!0;r+=1}return!1},g="function"!=typeof Object.keys||h?n(function(e){if(Object(e)!==e)return[];var t,r,n=[],o=h&&p(e);for(t in e)!c(t,e)||o&&"length"===t||(n[n.length]=t);if(d)for(r=f.length-1;r>=0;)c(t=f[r],e)&&!v(n,t)&&(n[n.length]=t),r-=1;return n}):n(function(e){return Object(e)!==e?[]:Object.keys(e)}),y=n(function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});function m(e,t,r,n){var o=i(e);function s(e,t){return A(e,t,r.slice(),n.slice())}return!a(function(e,t){return!a(s,t,e)},i(t),o)}function A(e,t,r,n){if(u(e,t))return!0;var o,s,i=y(e);if(i!==y(t))return!1;if("function"==typeof e["fantasy-land/equals"]||"function"==typeof t["fantasy-land/equals"])return"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t)&&"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e);if("function"==typeof e.equals||"function"==typeof t.equals)return"function"==typeof e.equals&&e.equals(t)&&"function"==typeof t.equals&&t.equals(e);switch(i){case"Arguments":case"Array":case"Object":if("function"==typeof e.constructor&&"Promise"===(o=e.constructor,null==(s=String(o).match(/^function (\w*)/))?"":s[1]))return e===t;break;case"Boolean":case"Number":case"String":if(typeof e!=typeof t||!u(e.valueOf(),t.valueOf()))return!1;break;case"Date":if(!u(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(e.source!==t.source||e.global!==t.global||e.ignoreCase!==t.ignoreCase||e.multiline!==t.multiline||e.sticky!==t.sticky||e.unicode!==t.unicode)return!1}for(var a=r.length-1;a>=0;){if(r[a]===e)return n[a]===t;a-=1}switch(i){case"Map":return e.size===t.size&&m(e.entries(),t.entries(),r.concat([e]),n.concat([t]));case"Set":return e.size===t.size&&m(e.values(),t.values(),r.concat([e]),n.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var l=g(e);if(l.length!==g(t).length)return!1;var p=r.concat([e]),d=n.concat([t]);for(a=l.length-1;a>=0;){var f=l[a];if(!c(f,t)||!A(t[f],e[f],p,d))return!1;a-=1}return!0}var b=o(function(e,t){return A(e,t,[],[])});var I=n(function(e){return null!=e&&"function"==typeof e["fantasy-land/empty"]?e["fantasy-land/empty"]():null!=e&&null!=e.constructor&&"function"==typeof e.constructor["fantasy-land/empty"]?e.constructor["fantasy-land/empty"]():null!=e&&"function"==typeof e.empty?e.empty():null!=e&&null!=e.constructor&&"function"==typeof e.constructor.empty?e.constructor.empty():e==Set||e instanceof Set?new Set:e==Map||e instanceof Map?new Map:s(e)?[]:function(e){return"[object String]"===Object.prototype.toString.call(e)}(e)?"":function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)?{}:p(e)?function(){return arguments}():function(e){var t=Object.prototype.toString.call(e);return"[object Uint8ClampedArray]"===t||"[object Int8Array]"===t||"[object Uint8Array]"===t||"[object Int16Array]"===t||"[object Uint16Array]"===t||"[object Int32Array]"===t||"[object Uint32Array]"===t||"[object Float32Array]"===t||"[object Float64Array]"===t||"[object BigInt64Array]"===t||"[object BigUint64Array]"===t}(e)?e.constructor.from(""):void 0}),w=n(function(e){return null!=e&&b(e,I(e))});const P=e=>!(e=>void 0===e)(e)&&(e=>null!=e)(e)&&(e=>!w(e))(e),O={LOG:{value:0,method:console.log},INFO:{value:1,method:console.info},DEBUG:{value:2,method:console.debug},WARN:{value:3,method:console.warn},ERROR:{value:4,method:console.error}};const k=e=>e&&(e[t]||e.AM);const S=new class{constructor(e,t){this.level=+t||O.ERROR.value,this.scope=e||""}setLogLevel(e){if(e&&"string"==typeof e){const t=e.toUpperCase();this.level=O[t]?O[t].value:this.level}}setScope(e){this.scope=e||this.scope}log(...e){this.logBase(e,O.LOG.value)}info(...e){this.logBase(e,O.INFO.value)}debug(...e){this.logBase(e,O.DEBUG.value)}warn(...e){this.logBase(e,O.WARN.value)}error(...e){this.logBase(e,O.ERROR.value)}logBase(e,t){if(this.level<=t){Object.values(O).find(e=>e.value===t).method(...this.getLogData(e))}}getLogData(e){if(Array.isArray(e)&&e.length>0){let t="%c RS SDK";this.scope&&(t=`${t} - ${this.scope}`);t=`${t} %c ${e[0].trim()}`;const r=[];return r.push(t),r.push("font-weight: bold; background: black; color: white;"),r.push("font-weight: normal;"),r.push(...e.slice(1)),r}return e}}(t);return e.Amplitude=class{constructor(e,t,r){t.logLevel&&S.setLogLevel(t.logLevel),this.name="AM",this.analytics=t,this.apiKey=e.apiKey,this.proxyServerUrl=e.proxyServerUrl,this.residencyServer=e.residencyServer,this.trackAllPages=e.trackAllPages||!1,this.trackNamedPages=e.trackNamedPages||!1,this.trackCategorizedPages=e.trackCategorizedPages||!1,this.attribution=e.attribution||!1,this.flushQueueSize=e.eventUploadThreshold||30,this.flushIntervalMillis=+e.eventUploadPeriodMillis||1e3,this.trackNewCampaigns=e.trackNewCampaigns||!0,this.trackRevenuePerProduct=e.trackRevenuePerProduct||!1,this.preferAnonymousIdForDeviceId=e.preferAnonymousIdForDeviceId||!1,this.traitsToSetOnce=(e=>{const t=[];return e.traitsToSetOnce&&e.traitsToSetOnce.length>0&&e.traitsToSetOnce.forEach(e=>{e?.traits&&""!==e.traits&&t.push(e.traits)}),t})(e),this.traitsToIncrement=(e=>{const t=[];return e.traitsToIncrement&&e.traitsToIncrement.length>0&&e.traitsToIncrement.forEach(e=>{e?.traits&&""!==e.traits&&t.push(e.traits)}),t})(e),this.appendFieldsToEventProps=e.appendFieldsToEventProps||!1,this.unsetParamsReferrerOnNewSession=e.unsetParamsReferrerOnNewSession||!1,this.trackProductsOnce=e.trackProductsOnce||!1,this.versionName=e.versionName,this.groupTypeTrait=e.groupTypeTrait,this.groupValueTrait=e.groupValueTrait,({shouldApplyDeviceModeTransformation:this.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:this.propagateEventsUntransformedOnError,destinationId:this.destinationId}=r??{})}init(){this.analytics.loadIntegration&&function(e,t){var r=e.amplitude||{_q:[],_iq:{}};if(r.invoked)e.console&&console.error&&console.error("Amplitude snippet has been loaded.");else{var n=function(e,t){e.prototype[t]=function(){return this._q.push({name:t,args:Array.prototype.slice.call(arguments,0)}),this}},o=function(e,t,r){return function(n){e._q.push({name:t,args:Array.prototype.slice.call(r,0),resolve:n})}},s=function(e,t,r){e[t]=function(){if(r)return{promise:new Promise(o(e,t,Array.prototype.slice.call(arguments)))}}},i=function(e){for(var t=0;t<v.length;t++)s(e,v[t],!1);for(var r=0;r<g.length;r++)s(e,g[r],!0)};r.invoked=!0;var a=t.createElement("script");a.setAttribute("data-loader","RS_JS_SDK"),a.type="text/javascript",a.integrity="sha384-TPZhteUkZj8CAyBx+GZZytBdkuKnhKsSKcCoVCq0QSteWf/Kw5Kb9oVFUROLE1l3",a.crossOrigin="anonymous",a.async=!0,a.src="https://cdn.amplitude.com/libs/analytics-browser-1.9.1-min.js.gz",a.onload=function(){e.amplitude.runQueuedFunctions||console.log("[Amplitude] Error: could not load SDK")};var c=t.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c);for(var u=function(){return this._q=[],this},l=["add","append","clearAll","prepend","set","setOnce","unset","preInsert","postInsert","remove","getUserProperties"],p=0;p<l.length;p++)n(u,l[p]);r.Identify=u;for(var d=function(){return this._q=[],this},f=["getEventProperties","setProductId","setQuantity","setPrice","setRevenue","setRevenueType","setEventProperties"],h=0;h<f.length;h++)n(d,f[h]);r.Revenue=d;var v=["getDeviceId","setDeviceId","getSessionId","setSessionId","getUserId","setUserId","setOptOut","setTransport","reset"],g=["init","add","remove","track","logEvent","identify","groupIdentify","setGroup","revenue","flush"];i(r),r.createInstance=function(e){return r._iq[e]={_q:[]},i(r._iq[e]),r._iq[e]},e.amplitude=r}}(window,document);const e={attribution:{disabled:this.attribution,trackNewCampaigns:!this.trackNewCampaigns},flushQueueSize:this.flushQueueSize,flushIntervalMillis:this.flushIntervalMillis,appVersion:this.versionName};var t;P(this.proxyServerUrl)&&(this.proxyServerUrl.startsWith("http://")?S.error(`Please use a secure proxy server URL: ${this.proxyServerUrl}`):e.serverUrl=(t=this.proxyServerUrl).startsWith("https://")?t:`https://${t}`),"EU"===this.residencyServer&&(e.serverZone="EU"),(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>-1)&&(e.transport="xhr"),this.preferAnonymousIdForDeviceId&&this.analytics&&(e.deviceId=this.analytics.getAnonymousId()),window.amplitude.init(this.apiKey,null,e)}isLoaded(){return Boolean(window.amplitude?.getDeviceId())}isReady(){return this.isLoaded()}identify(e){this.setDeviceId(e);const{traits:t}=e.message.context,{userId:r,integrations:n}=e.message,o=(e=>{const t=k(e),r=t?.fieldsToUnset||void 0;if(r&&Array.isArray(r)&&r.length>0)return r})(n),s=new window.amplitude.Identify;let i=!1;o&&(i=!0,o.forEach(e=>{s.unset(e)})),r&&window.amplitude.setUserId(r),t&&(i=!0,Object.keys(t).forEach(e=>{const r=this.traitsToIncrement.includes(e),n=this.traitsToSetOnce.includes(e);r&&s.add(e,t[e]),n&&s.setOnce(e,t[e]),r||n||s.set(e,t[e])})),i&&window.amplitude.identify(s)}track(e){this.setDeviceId(e);const{properties:t}=e.message,{products:r}=t,n={};if(Object.assign(n,e.message),this.trackProductsOnce)if(r&&Array.isArray(r)){const e=[],t=Object.keys(r);for(let n=0;n<t.length;n+=1){let t={};t=this.getProductAttributes(r[n]),e.push(t)}if(n.properties.products=e,this.logEventAndCorrespondingRevenue(n,this.trackRevenuePerProduct),this.trackRevenuePerProduct){const e={};Object.assign(e,n),this.trackingEventAndRevenuePerProduct(e,r,!1)}}else this.logEventAndCorrespondingRevenue(n,!1);else if(r&&Array.isArray(r)){delete n.properties.products,this.logEventAndCorrespondingRevenue(n,this.trackRevenuePerProduct);const e={};Object.assign(e,n),this.trackingEventAndRevenuePerProduct(e,r,!0)}else this.logEventAndCorrespondingRevenue(n,!1)}trackingEventAndRevenuePerProduct(e,t,r){const n=e;let{revenueType:o}=n.properties;const{revenue:s,revenue_type:i}=n.properties;o=o||i,t.forEach(e=>{n.properties=e,n.event="Product Purchased",this.trackRevenuePerProduct&&(o&&(n.properties.revenueType=o),s&&(n.properties.revenue=s),this.trackRevenue(n)),r&&this.logEventAndCorrespondingRevenue(n,!0)})}logEventAndCorrespondingRevenue(e,t){const{properties:r,event:n}=e;window.amplitude.track(n,r),r.revenue&&!t&&this.trackRevenue(e)}page(e){this.setDeviceId(e);const{properties:t,name:r,category:n,integrations:o}=e.message,s=k(o),i=s?.useNewPageEventNameFormat||!1;if(this.trackAllPages){const e="Loaded a page";window.amplitude.track(e,t)}if(n&&this.trackCategorizedPages){let e;e=i?`Viewed ${n} Page`:`Viewed page ${n}`,window.amplitude.track(e,t)}if(r&&this.trackNamedPages){let e;e=i?`Viewed ${r} Page`:`Viewed page ${r}`,window.amplitude.track(e,t)}}group(e){this.setDeviceId(e);const{groupId:t,traits:r}=e.message,{groupTypeTrait:n}=this,{groupValueTrait:o}=this;let s,i;n&&o&&r&&(s=r[n],i=r[o]),s&&i?window.amplitude.setGroup(n,o):t&&window.amplitude.setGroup("[Rudderstack] Group",t)}setDeviceId(e){const{anonymousId:t}=e.message;this.preferAnonymousIdForDeviceId&&t&&window.amplitude.setDeviceId(t)}trackRevenue(e){const{properties:t,event:r}=e;let{price:n,productId:o,quantity:s}=t;const{revenue:i,product_id:a,revenue_type:c}=t,u=t.revenueType||c||{"order completed":"Purchase","completed order":"Purchase","product purchased":"Purchase"}[r.toLowerCase()];if(o=o||a,!i&&!n)return void S.error('Neither "revenue" nor "price" is available. Hence, aborting');n||(n=i,s=1),s||(s=1);const l=(new window.amplitude.Revenue).setPrice(n).setQuantity(s).setEventProperties(t);u&&l.setRevenueType(u),o&&l.setProductId(o),l._properties&&(delete l._properties.price,delete l._properties.productId,delete l._properties.quantity),window.amplitude.revenue(l)}getProductAttributes(e){return{productId:e.productId||e.product_id,sku:e.sku,name:e.name,price:e.price,quantity:e.quantity,category:e.category}}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e}({});
//# sourceMappingURL=Amplitude.min.js.map
